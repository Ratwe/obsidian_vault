# [[План запросов SQL]]
Взяли БД Паши Раужева про студии звукозаписи.

```sql
explain analyze
select * from lab1.table_equip
```
Вывелась инфа про:
- scanning time
- execution time
- rows, width...

```sql
explain analyze
select e."type", s.add
	join lab1.table_eq_stud es on e.equip_id = es.equip_id
	join lab1.table_stud s on es.studion_id = s.studio_id
```
Видим последовательность запросов, типы соединений, функции хэширования.
cost=62.00..107.50 - минимальная и максимальная стоимость выполнения запросов. На семинарах говорим, что измеряется в "воробушках" - условная величина. 

С точки зрения человеческой логики, БД может положить в хэш неправильную таблицу. Можно неявно указать, что класть в хэш, через хэш-индексы.

- Seq Scan - последовательный скан
- Index Scan - используется, когда в запросе есть сущности, связанные с индексом. 

Последовательность действий в очереди запроса в *explain analyze* идёт снизу вверх.

## Поиск самой дорогой студии
Если мы уверены, что значения не могут совпадать: *sum* + limit 1.
Если значения могут совпадать: *рекурсией*.
Оконные функции работают медленнее всего.
### Zero-links
[[00 БД]]