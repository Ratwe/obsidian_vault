Используем Int 8h, Windows XP, режим V86.

Процессоры Intel могут работать в трёх режимах: 
1. Реальный режим (16-разрядный)
2. Защищённый режим (32-разрядный). Многопроцессорный.
	1. Специальный режим - V86 (16-разрядный, эмуляция DOS-BOX)
3. Длинный режим - режим long. (64-разрядный) 
	1. Режим совместимости compability (32-разрядный)

В V86 можем получить доступ к коду обработчика прерывания от системного таймера. То бишь от прерывания Int8h.

Реальную работающую ОС можно дизассемблировать.

В обработчиках прерываний циклов быть не может.

Регистры делятся пополам: аппаратно доступна младшая половина регистра. 

Утилиты: Sourcer
Sourcer был написан на основе Intel 80/86.

Аппаратные прерывания:
1. от сиcтемного таймера
2. от внешний устройств
3. от действий оператора

8е прерывание DOS'а выполняет:
1. Инкремент счётчика реального времени. Счётчик находится в физической (оперативной) памяти. Имеется энергонезависимая микросхема CMOS. **Почитать на вики.** Содержит счётчик реального времени, дней, месяцев. Когда включается компьютер - значение из счётчика копируется в оперативную память. Дальше используется. 18.2 раз в секунду, т.к. генератор импульсов с частотой 18.2 Гц. Прерывание от таймера - единственное периодическое аппаратное прерывание системы. Прерывания трёх видов: системные, исключения (деление на 0 нельзя, т.к. разрядность регистров), аппаратные (появились с идеей распараллеливания функций для информировании о завершении ввода/вывода).
2. Декремент счётчика до выключения моторчика дисковода (флопик - дискета). Когда ноль - в порт дисковода посылается сигнал отключения. Подключен к порту, значит устройство располагается по адресу порта. С портами работают команды in (посылка в порт дисковода сигнала) и out (end of interrupt - сброс контроллера прерываний).
3. Вызов пользовательского прерывания 1Ch. В чистом виде это заглушка. Если написать в Int8h огромный код - ничего не будет работать, пока он не выполнится. Любое аппаратное прерывание выполняется на самых высоких уровнях приоритета. Прерывает любую выполняемую работу (DOS не является исключением).  

В отчёте: листинг Int 8h кода, его алгоритм, листинг *субратимы*, алгоритм. Никаких выводов. После вызова субратимы будет 4 вызова ax, bx, cx, dx, после jumpa будет 4 вызова ax, bx, cx, dx -- сохранение и восстановление аппаратного контекста потому что прерывается выполнение любой другой программы. Будет инкремент счётчика реального времени. Не стесняться инкремента и декремента. После jump'а многоточие. Дальше - IRET. Любой код обработчика прерываний заканчивается IRET (end of interrupt).

Декремент счётчика моторчика было важнейшей функцией для DOSа, и это пример отложенного действия. 


Нужно: установить на виртуалку XP.

### Zero-links
[[00 ОС]]

### Links 
[[int8h]]